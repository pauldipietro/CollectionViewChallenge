<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://xamarin.com/schemas/2014/forms"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:d="http://xamarin.com/schemas/2014/forms/design"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:ff="clr-namespace:FFImageLoading.Forms;assembly=FFImageLoading.Forms"
             xmlns:models="clr-namespace:CollectionViewChallenge.Models"
             xmlns:consts="clr-namespace:CollectionViewChallenge.Utility.Constants"
             xmlns:controls="clr-namespace:CollectionViewChallenge.Controls"
             mc:Ignorable="d"
             x:Class="CollectionViewChallenge.Views.CollectionViewChallengePage">
    <ContentPage.Content>
        <StackLayout>

            <CollectionView
                ItemsSource="{Binding Games}">
                <CollectionView.ItemTemplate>
                    <DataTemplate x:DataType="models:GameModel">
                        <StackLayout
                            Padding="{x:Static consts:Thicknesses.CellPadding8}"
                            Spacing="8"
                            Orientation="Horizontal"
                            BackgroundColor="White">
                            <StackLayout.Triggers>
                                <DataTrigger TargetType="StackLayout"
                                    Binding="{Binding EarnedTrophies.Platinum}"
                                    Value="1">
                                    <Setter Property="BackgroundColor" Value="{x:Static consts:Colours.PlatinumEarnedCellBackgroundColour}" />
                                </DataTrigger>
                            </StackLayout.Triggers>

                            <ff:CachedImage
                                x:Name="IconImage"
                                WidthRequest="100"
                                HeightRequest="56"
                                Aspect="AspectFit"
                                DownsampleToViewSize="true"
                                Source="{Binding Icon, Mode=OneTime}"/>

                            <StackLayout
                                Spacing="2"
                                Orientation="Vertical"
                                VerticalOptions="Center"
                                HorizontalOptions="Start">
                            <Label
                                x:Name="TitleLabel"
                                Text="{Binding Title}"
                                Style="{StaticResource TitleLabelStyle}"/>
                            <Label
                                x:Name="TrophyCountLabel"
                                Text="{Binding ., Converter={StaticResource TrophyCountConverter}}"
                                Style="{StaticResource MicroSubtitleLabelStyle}"/>
                            <Label
                                x:Name="LastUpdatedLabel"
                                Text="{Binding LastUpdatedDate, Converter={StaticResource StringDateConverter}, ConverterParameter='{0} MMMM yyyy'}"
                                Style="{StaticResource MicroSubtitleLabelStyle}"/>
                            </StackLayout>

                            <controls:TagControl
                                Spacing="2"
                                Orientation="Vertical"
                                MinimumWidthRequest="38"
                                VerticalOptions="CenterAndExpand"
                                HorizontalOptions="EndAndExpand"
                                Tags="{Binding PlatformTags}"
                                TagPadding="5, 1"
                                TagCornerRadius="2"
                                TagColour="{x:Static consts:Colours.PrimaryColour}"/>

                        </StackLayout>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>

        </StackLayout>
    </ContentPage.Content>
</ContentPage>